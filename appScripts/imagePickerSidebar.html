<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body>
  <h2>Select an image:</h2>
  <div id="imageContainer">
    Loading images...
  </div>

  <script>
    // Function to get the images from Google Drive and display them in the sidebar
    google.script.run.withSuccessHandler(displayImages).getDriveImages();

    function displayImages(images) {
      var imageContainer = document.getElementById('imageContainer');
      imageContainer.innerHTML = '';
      
      images.forEach(function(imageUrl) {
        var img = document.createElement('img');
        img.src = imageUrl;
        img.style.cursor = 'pointer';
        img.style.margin = '5px';
        img.onclick = function() {
          insertImage(imageUrl);
        };
        imageContainer.appendChild(img);
      });
    }

    // Function to insert the selected image URL into the spreadsheet
    function insertImage(url) {
      google.script.run.insertImageUrl(url);
    }
  </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
  <title>Fetch Google Sheets and Create Divs</title>
</head>
<body>
  <div id="data-container"></div>

  <script>
    function handleResponse(response) {
      var jsonData = response.values;

      // Create divs for each value in the sheet that starts with "block"
      for (var i = 0; i < jsonData.length; i++) {
        var value = jsonData[i][0]; // Assuming the values are in the first column (column A)
        if (value && value.startsWith("block")) {
          var blockNumber = value.substring(5); // Extract the number from the value (assuming the format "block1", "block2", etc.)

          // Create a new div element
          var div = document.createElement("div");
          div.id = "block" + blockNumber;
          document.body.appendChild(div);

          // Place the value from column C (assuming the third column) inside the div using an h1 element
          var thirdValue = jsonData[i][2]; // Assuming the third value is in the third column (column C)
          if (thirdValue) {
            var h1 = document.createElement("h1");
            h1.textContent = thirdValue;
            div.appendChild(h1);
          }
        }
      }
    }

    function fetchSheetData() {
      var apiKey = 'AIzaSyCNb3QEXaLYWUI3gVY-LOn0jKj1kcpT_e0';
      var sheetId = '1XTPqQhuETtk8WFFS6IN2q9HRmQPdyFQe5pF5fs1zji4';
      var sheetRange = 'Sheet1!A:C'; // Assuming the data is in columns A, B, and C of Sheet1

      var sheetUrl = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetRange}?key=${apiKey}`;

      fetch(sheetUrl)
        .then(function(response) {
          if (!response.ok) {
            throw new Error('Failed to fetch Google Sheets data');
          }
          return response.json();
        })
        .then(function(data) {
          handleResponse(data);
        })
        .catch(function(error) {
          var errorMessage = 'Error fetching Google Sheets data: ' + error.message;
          var errorContainer = document.getElementById('data-container');
          errorContainer.textContent = errorMessage;
        });
    }

    // Fetch the Google Sheets data and create divs on page load
    fetchSheetData();
  </script>
</body>
</html>
